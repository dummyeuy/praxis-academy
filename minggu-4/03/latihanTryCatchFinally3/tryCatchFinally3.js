function func() {
    // start doing something that needs completion (like measurements)
    try {
      // ...
    } finally {
      // complete that thing even if all dies
    }
  }